!function(e,o,t){"use strict";let n,i,s,a=!1,l={added:!1},r={isCompatible:!1,beforeInstallPrompt:null},d={},p={appID:"com.love2dev.addtohome",appName:"Progressive Web App",debug:!1,logging:!1,modal:!1,mandatory:!1,autostart:!0,skipFirstVisit:!1,minSessions:0,startDelay:1,lifespan:15,displayPace:1,mustShowCustomPrompt:!1,maxDisplayCount:0,validLocation:[],onInit:null,onShow:null,onAdd:null,onInstall:null,onCancel:null,customCriteria:null,manualPrompt:null};const u={lastDisplayTime:0,returningVisitor:!1,displayCount:0,optedout:!1,added:!1,sessions:0,nextSession:0};function c(e){if(!n)if(n={trigger:C,updateSession:v,clearSession:A,removeSession:f,optOut:w,optIn:P,clearDisplayCount:D,triggerNativePrompt:g},"serviceWorker"in navigator){o.querySelector("[rel='manifest']")?(d=Object.assign({},p,e),navigator.serviceWorker.getRegistration().then(h)):console.log("no manifest file")}else m("service worker not supported"),m("Add to homescreen: not displaying callout because service workers are not supported");return n}function m(e){d.logging&&(d.logger?d.logger.log(e):console.log(e))}async function g(){if(!r.beforeInstallPrompt)return Promise.resolve();try{await r.beforeInstallPrompt.prompt();const e=await r.beforeInstallPrompt.userChoice;l.added="accepted"===e.outcome,l.added?(m("User accepted the A2HS prompt"),d.onAdd&&d.onAdd(e)):(d.onCancel&&d.onCancel(e),l.optedout=!0,m("User dismissed the A2HS prompt")),v(),r.beforeInstallPrompt=null}catch(e){if(m(e.message),e.message.indexOf("user gesture")>-1)d.mustShowCustomPrompt=!0,S();else{if(!(e.message.indexOf("The app is already installed")>-1))return console.log(e),e;l.added=!0,v()}}}function f(e){localStorage.removeItem(e||c.defaults.appID)}async function h(t){if(n.sw=t,!n.sw)return console.log("no service worker"),void(r.isCompatible=!1);(l=JSON.parse(localStorage.getItem(d.appID)))||(l=u),"string"==typeof l&&(l=JSON.parse(l)),l.sessions+=1,v(),function(){const t=e.navigator.userAgent;r.isIDevice=/iphone|ipod|ipad|macintosh/i.test(t)&&"ontouchend"in o,r.isSamsung=/Samsung/i.test(t),r.isFireFox=/Firefox/i.test(t),r.isOpera=/opr/i.test(t),r.isEdge=/Edg/i.test(t),r.isChrome=/Chrome/.test(t)&&!r.isEdge,r.isAndroid=/android/i.test(t),r.isWindows=/Windows NT/i.test(t),r.isMacOS=/Macintosh/i.test(t)&&!r.isIDevice,r.isFireFox&&(r.isFireFox=/android/i.test(t)),r.isOpera&&(r.isOpera=/android/i.test(t)),r.isChromium="onbeforeinstallprompt"in e,r.isInWebAppiOS=!0===e.navigator.standalone,r.isInWebAppChrome=e.matchMedia("(display-mode: standalone)").matches,r.isMobileSafari=r.isIDevice&&t.indexOf("Safari")>-1&&t.indexOf("CriOS")<0,r.isStandalone=r.isInWebAppiOS||r.isInWebAppChrome||e.matchMedia("(display-mode: fullscreen)").matches,r.isiPad=r.isMobileSafari&&t.indexOf("iPad")>-1,r.isiPhone=r.isMobileSafari&&-1===t.indexOf("iPad"),r.isCompatible=r.isChromium||r.isMobileSafari||r.isSamsung||r.isFireFox||r.isOpera||r.isIDevice,r.isInstalled=l.added,r.isStandalone&&(l.added=!0,r.isInstalled=!0,v())}(),d&&d.debug&&void 0===d.logging&&(d.logging=!0),d.mandatory=d.mandatory&&("standalone"in e.navigator||d.debug),d.modal=d.modal||d.mandatory,d.mandatory&&(d.startDelay=-.5),d.debug&&(r.isCompatible=!0),d.onInit&&d.onInit(n),d.autostart?(m("Add to homescreen: autostart displaying callout"),b()):a?I():b()}function y(){if(null!==d.customCriteria||d.customCriteria!==t){let e=!1;return e="function"==typeof d.customCriteria?d.customCriteria():!!d.customCriteria,d.customCriteria=e,e||m("Add to homescreen: not displaying callout because a custom criteria was not met."),e}return d.customCriteria}function b(e){!l.shown||e?(l.shown=!0,"interactive"===o.readyState||"complete"===o.readyState?S():o.onreadystatechange=function(){"complete"===o.readyState&&S()}):m("Add to homescreen: not displaying callout because already shown on screen")}function S(e){setTimeout(I,1e3*d.startDelay+500)}function I(){(i!==t?i:(i=!1,r.isInstalled?i:y()?r.isCompatible?Date.now()-l.lastDisplayTime<6e4*d.displayPace?(m("Add to homescreen: not displaying callout because displayed recently"),0):d.maxDisplayCount&&l.displayCount>=d.maxDisplayCount?(m("Add to homescreen: not displaying callout because displayed too many times already"),0):l.sessions<d.minSessions?(m("Add to homescreen: not displaying callout because not enough visits"),0):d.nextSession&&d.nextSession>0&&l.sessions>=d.nextSession?(m("Add to homescreen: not displaying callout because waiting on session "+d.nextSession),0):l.optedout?(m("Add to homescreen: not displaying callout because user opted out"),0):l.added?(m("Add to homescreen: not displaying callout because already added to the homescreen"),0):r.isStandalone?(l.added||(l.added=!0,v(),d.onAdd&&d.onAdd(n,l)),m("Add to homescreen: not displaying callout because in standalone mode"),0):!l.returningVisitor&&(l.returningVisitor=!0,v(),d.skipFirstVisit)?(m("Add to homescreen: not displaying callout because skipping first visit"),0):(i=!0,1):(m("Add to homescreen: not displaying callout because device not supported"),0):(s=!1,0)))?(n.beforeInstallPrompt="onbeforeinstallprompt"in e,d.onShow&&d.onShow(r,l,n),l.lastDisplayTime=Date.now(),l.displayCount++,v()):(s!==t?s:(s=!1,n.beforeInstallPrompt="onbeforeinstallprompt"in e,y()?l.optedout||l.added||r.isStandalone||!r.isCompatible||r.isInWebAppiOS?s:(s=!0,1):(s=!1,0)))?d.onCanInstall&&d.onCanInstall(r,l,n):r.isInstalled?d.onInstalled&&d.onInstalled(r,l,n):r.isCompatible&&d.onShow&&!r.isInstalled&&d.onShow(r,l,n)}function C(){I()}function v(){localStorage.setItem(d.appID,JSON.stringify(l))}function A(){l=u,v()}function w(){l.optedout=!0,v()}function P(){l.optedout=!1,v()}function D(){l.displayCount=0,l.shown=!1,l.lastDisplayTime=0,v()}"onbeforeinstallprompt"in e&&(e.addEventListener("beforeinstallprompt",function(e){e.preventDefault(),r.beforeInstallPrompt=e,d.onBeforeInstallPrompt&&d.onBeforeInstallPrompt(r)}),a=!0),"onappinstalled"in e&&e.addEventListener("appinstalled",e=>{m("a2hs installed"),l.added=!0,v(),d.onInstall&&d.onInstall(e)}),r.cancelPrompt=function(e){return e.preventDefault(),d.onCancel&&d.onCancel(),!1},r.handleInstall=function(e){var o;return d.onInstall&&d.onInstall(e),!r.beforeInstallPrompt||d.debug&&"native"!==(d.debug&&"string"==typeof d.debug?d.debug:r.isChromium&&o===t&&!o?"native":r.isFireFox?"firefox":r.isiPad?"ipad":r.isiPhone?"iphone":r.isOpera?"opera":r.isSamsung?"samsung":r.isEdge?"edge":r.isChromium?"chromium":"")||g(),!1},e.addToHomescreen=c}(window,document);